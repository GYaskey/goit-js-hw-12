{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/js/iziToastErrors.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nexport async function fetchImages(q, currentPage) {\n  const BASE_URL = 'https://pixabay.com/api/';\n  const API_KEY = '45001500-719c9808934d73fced765b961';\n  const params = {\n    key: API_KEY,\n    q,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    page: currentPage,\n    per_page: 15,\n  };\n\n  try {\n    const res = await axios.get(BASE_URL, { params });\n    return res.data;\n  } catch (error) {\n    throw new Error(error.response.status);\n  }\n}\n","export function renderImages(arr) {\n  if (!arr || arr.hits.length === 0) {\n    return '';\n  }\n\n  return arr.hits\n    .map(image => {\n      return `<li class=\"img-item\">\n  <a href=\"${image.largeImageURL}\" class=\"img-link\">\n    <img src=\"${image.webformatURL}\" alt=\"${image.tags}\" class=\"img-picture\" />\n  </a>\n  <ul class=\"img-stats\">\n    <li>\n      <p class=\"img-text\">\n        Likes\n        <span class=\"img-stat\">${image.likes}</span>\n      </p>\n    </li>\n    <li>\n      <p class=\"img-text\">\n        Views\n        <span class=\"img-stat\">${image.views}</span>\n      </p>\n    </li>\n    <li>\n      <p class=\"img-text\">\n        Comments\n        <span class=\"img-stat\">${image.comments}</span>\n      </p>\n    </li>\n    <li>\n      <p class=\"img-text\">\n        Downloads\n        <span class=\"img-stat\">${image.downloads}</span>\n      </p>\n    </li>\n  </ul>\n</li>\n`;\n    })\n    .join('');\n}\n","import iziToast from 'izitoast';\n\nexport function emptyQueryErr() {\n  iziToast.error({\n    title: 'Error',\n    message: 'Please type your request!',\n    position: 'topRight',\n    backgroundColor: '#EF4040',\n    iconColor: '#fff',\n    messageColor: '#fff',\n    titleColor: '#fff',\n  });\n}\n\nexport function noImgFoundErr() {\n  iziToast.error({\n    title: 'Error',\n    message:\n      'Sorry, there are no images matching your search query. Please try again!',\n    position: 'topRight',\n    backgroundColor: '#EF4040',\n    iconColor: '#fff',\n    messageColor: '#fff',\n    titleColor: '#fff',\n  });\n}\n\nexport function globalErr(error) {\n  iziToast.error({\n    title: 'Error',\n    message: `Sorry, something went wrong: ${error.message}`,\n    position: 'topRight',\n    backgroundColor: '#EF4040',\n    iconColor: '#fff',\n    messageColor: '#fff',\n    titleColor: '#fff',\n  });\n}\n\nexport function noMoreImg() {\n  iziToast.info({\n    title: 'Oops',\n    message: `We're sorry, but you've reached the end of search results.`,\n    position: 'topRight',\n    backgroundColor: 'rgba(151, 255, 245)',\n    iconColor: '#000',\n    messageColor: '#000',\n    titleColor: '#000',\n  });\n}\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport { fetchImages } from './js/pixabay-api';\nimport { renderImages } from './js/render-functions';\nimport axios from 'axios';\nimport {\n  emptyQueryErr,\n  globalErr,\n  noImgFoundErr,\n  noMoreImg,\n} from './js/iziToastErrors';\n\nexport const refs = {\n  form: document.querySelector('.form'),\n  list: document.querySelector('.img-list'),\n  imgItem: document.querySelector('.img-item'),\n  loader: document.querySelector('.loader'),\n  btnLoadMore: document.querySelector('.js-btn-load-more'),\n  spinner: document.querySelector('.js-spinner'),\n};\n\nrefs.form.addEventListener('submit', onFormSubmit);\nlet query = '';\nlet currentPage = 1;\nlet maxPage = null;\nconst perPage = 15;\n\nasync function onFormSubmit(e) {\n  e.preventDefault();\n  currentPage = 1;\n  refs.list.innerHTML = '';\n  query = e.target.elements.searchInput.value.trim();\n  if (query === '') {\n    emptyQueryErr();\n    hideLoadMoreBtn();\n    return;\n  }\n\n  e.target.reset();\n  refs.loader.classList.remove('visually-hidden');\n\n  try {\n    const qRes = await fetchImages(query, currentPage);\n    maxPage = Math.ceil(qRes.totalHits / perPage);\n    if (qRes.hits.length === 0) {\n      hideLoadMoreBtn();\n      noImgFoundErr();\n      refs.loader.classList.add('visually-hidden');\n      return '';\n    }\n\n    const markup = renderImages(qRes);\n    refs.list.innerHTML = markup;\n    refs.loader.classList.add('visually-hidden');\n    checkBtnStatus();\n    lightbox.refresh();\n  } catch (error) {\n    checkBtnStatus();\n    globalErr(error);\n  }\n}\n\n//?=======================================================================\n\nconst lightbox = new SimpleLightbox('.img-list a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nfunction showLoadMoreBtn() {\n  refs.btnLoadMore.classList.remove('visually-hidden');\n}\n\nfunction hideLoadMoreBtn() {\n  refs.btnLoadMore.classList.add('visually-hidden');\n}\n\nrefs.btnLoadMore.addEventListener('click', onLoadBtnClick);\n\nasync function onLoadBtnClick() {\n  currentPage++;\n  try {\n    checkBtnStatus();\n    refs.spinner.classList.remove('visually-hidden');\n    const qRes = await fetchImages(query, currentPage);\n\n    if (qRes.hits.length === 0) {\n      checkBtnStatus();\n      noImgFoundErr();\n      refs.loader.classList.add('visually-hidden');\n\n      return '';\n    }\n\n    const markup = renderImages(qRes);\n    refs.list.insertAdjacentHTML('beforeend', markup);\n    scrollPage();\n    refs.spinner.classList.add('visually-hidden');\n    refs.loader.classList.add('visually-hidden');\n    lightbox.refresh();\n  } catch (error) {\n    checkBtnStatus();\n    globalErr(error);\n  }\n}\n\nfunction checkBtnStatus() {\n  if (currentPage >= maxPage) {\n    hideLoadMoreBtn();\n    noMoreImg();\n  } else {\n    showLoadMoreBtn();\n  }\n}\n\nfunction scrollPage() {\n  const singleCard = refs.list.firstElementChild;\n  const height = singleCard.getBoundingClientRect().height;\n  scrollBy({\n    top: height * 3,\n    behavior: 'smooth',\n  });\n}\n"],"names":["fetchImages","q","currentPage","BASE_URL","params","axios","error","renderImages","arr","image","emptyQueryErr","iziToast","noImgFoundErr","globalErr","noMoreImg","refs","onFormSubmit","query","maxPage","perPage","e","hideLoadMoreBtn","qRes","markup","checkBtnStatus","lightbox","SimpleLightbox","showLoadMoreBtn","onLoadBtnClick","scrollPage","height"],"mappings":"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"}